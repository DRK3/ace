#
# Copyright SecureKey Technologies Inc. All Rights Reserved.
#
# SPDX-License-Identifier: Apache-2.0
#
version: '2'

services:
  gatekeeper.trustbloc.local:
    container_name: gatekeeper.trustbloc.local
    image: ${GATEKEEPER_SERVER_IMAGE}:latest
    environment:
      - GK_HOST_URL=0.0.0.0:9014
      - GK_TLS_CACERTS=/etc/tls/ec-cacert.pem
      - GK_TLS_SERVE_CERT=/etc/tls/ec-pubCert.pem
      - GK_TLS_SERVE_KEY=/etc/tls/ec-key.pem
      - DATABASE_TYPE=mongodb
      - DATABASE_URL=mongodb://mongodb.example.com:27017
      - DATABASE_PREFIX=gatekeeper_
      - GK_VAULT_URL=https://TODO.vault.trustbloc.local
      - LOG_LEVEL=debug
    ports:
      - "9014:9014"
    volumes:
      - ./keys/tls:/etc/tls
    command: start
    depends_on:
      - mongodb.example.com
    networks:
      - bdd_net

  mongodb.example.com:
    container_name: mongodb.example.com
    image: ${MONGODB_IMAGE}:${MONGODB_IMAGE_TAG}
    ports:
      - ${MONGODB_PORT}:${MONGODB_PORT}
    networks:
      - bdd_net

networks:
  bdd_net:
    driver: bridge
